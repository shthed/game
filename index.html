<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Vector World â€” Babylon</title>
  <style>
    html, body { height: 100%; margin: 0; background: #87ceeb; touch-action: none; }
    #renderCanvas { width: 100%; height: 100%; display: block; cursor: crosshair; }
    #tests { position:fixed; left:10px; bottom:10px; z-index:7; background:rgba(0,0,0,.65); color:#e6edf3; padding:6px 8px; border-radius:8px; font:12px system-ui; white-space:pre; max-width:60vw; max-height:30vh; overflow:auto; }

    #optsBtn { position: fixed; right: 12px; top: 12px; z-index: 8; border: 0; padding: 10px 12px; border-radius: 10px; background: rgba(0,0,0,.65); color: #fff; font: 14px/1 system-ui; cursor: pointer; }
    #panel { position: fixed; right: 12px; top: 52px; z-index: 9; width: min(380px, 92vw); max-height: 80vh; overflow: auto; padding: 14px; border-radius: 12px; backdrop-filter: blur(6px); background: rgba(10,12,20,.85); color:#e6edf3; font: 13px system-ui; display: none; }
    #panel h3 { margin: 6px 0 8px; font-size: 14px; color: #bcd; }
    #panel label { display: flex; align-items: center; justify-content: space-between; gap: 10px; margin: 6px 0; }
    #panel input[type="range"] { width: 150px; }
    #panel .row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    #panel .actions { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
    #panel button, #panel select, #panel input[type="text"] { background: #1f2937; color:#e6edf3; border:1px solid #334155; border-radius:8px; padding:6px 10px; cursor:pointer; }
    #seedBox { width: 160px; }

    #helpBtn { position:fixed; top:12px; left:12px; z-index:8; background:#1f2937; border:1px solid #334155; color:#e6edf3; border-radius:8px; padding:8px 12px; cursor:pointer; }
    #helpDialog { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#111827; color:#e6edf3; width:min(640px,90vw); max-height:80vh; overflow:auto; padding:20px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,.6); display:none; z-index:21; }
    #helpDialog h2 { margin-top:0; }
    #helpDialog button { margin-top:10px; background:#1f2937; color:#e6edf3; border:1px solid #334155; border-radius:6px; padding:6px 12px; cursor:pointer; }
    #helpDialog pre { background:#0f172a; padding:10px; border-radius:6px; overflow:auto; }
    #helpVersion { margin: 0 0 12px; color: #9ca3af; font-size: 12px; }
  </style>
  <script defer src="https://cdn.babylonjs.com/babylon.js"></script>
</head>
<body>
  <canvas id="renderCanvas"></canvas>

  <button id="optsBtn" aria-haspopup="dialog">Options</button>
  <section id="panel" role="dialog" aria-modal="true" aria-label="Options">
    <h3>Controls</h3>
    <label>Invert look X <input id="optInvertX" type="checkbox"></label>
    <label>Invert look Y <input id="optInvertY" type="checkbox"></label>
    <label>Mouse sensitivity <input id="optSens" type="range" min="0.0005" max="0.02" step="0.0005" value="0.002"><span id="sensVal">0.002</span></label>
    <label>Walking speed (m/s) <input id="optSpeed" type="range" min="2" max="20" step="0.5" value="8"><span id="speedVal">8</span></label>
    <label>Right-click moves forward <input id="optRmb" type="checkbox" checked></label>

    <h3>Graphics</h3>
    <label>Quality
      <select id="optQuality">
        <option value="high">High</option>
        <option value="medium" selected>Medium</option>
        <option value="low">Low</option>
      </select>
    </label>
    <label>Show sky <input id="optSky" type="checkbox" checked></label>

    <h3>World</h3>
    <label>Tree count <input id="optTrees" type="range" min="0" max="200" step="5" value="30"><span id="treesVal">30</span></label>
    <div class="row"><label for="seedBox">Seed</label><input id="seedBox" type="text" inputmode="numeric" placeholder="auto" /><button id="btnApplySeed">Apply</button><button id="btnNewSeed">New</button></div>
    <div class="actions">
      <button id="btnRegenTrees">Regenerate trees</button>
      <button id="btnRegenGround">Regenerate ground texture</button>
      <button id="btnFullscreen">Fullscreen</button>
    </div>
  </section>

  <button id="helpBtn">Help</button>
  <div id="helpDialog" role="dialog" aria-modal="true" aria-label="Help Manual">
    <h2>Vector World Help</h2>
    <p id="helpVersion" aria-live="polite"></p>
    <p>Move with WASD/Arrows or left-half touch. Look with LMB drag or right-half touch. Hold RMB to walk forward.</p>
    <h3>Options</h3>
    <ul>
      <li>Controls: invert X/Y, sensitivity, walking speed, RMB forward toggle.</li>
      <li>Graphics: quality scaling, sky toggle.</li>
      <li>World: tree count, seed edit/new, regenerate trees and ground, fullscreen.</li>
    </ul>
    <h3>Persistence</h3>
    <p>Settings and seed save to your browser and load on startup.</p>
    <h3>Notes</h3>
    <ul>
      <li>No pointer lock. Works in sandboxed iframes.</li>
      <li>Trees use instancing for performance.</li>
      <li>Movement is delta-time scaled.</li>
    </ul>
    <button id="closeHelp">Close</button>
  </div>

  <pre id="tests" aria-hidden="true"></pre>

  <script type="module" src="js/app.js"></script>
</body>
</html>
